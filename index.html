<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Bake your cake</title>

  <!-- A-Frame + physics -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-physics-system@v3.3.0/dist/aframe-physics-system.min.js"></script>

  <style>
    body, html { margin:0; padding:0; height:100%; width:100%; font-family:sans-serif; background:#000; }

    #startScreen, #cakeChoices {
      position:absolute; inset:0; display:flex; flex-direction:column; justify-content:center; align-items:center;
      background-size:cover; background-position:center; z-index:100;
    }
    #startScreen { background-image: url('https://cdn.pixabay.com/photo/2015/01/14/19/20/bake-599521_1280.jpg'); }
    #cakeChoices { background-image: url('https://cdn.pixabay.com/photo/2015/01/14/19/20/bake-599521_1280.jpg'); display:none; }
    #startScreen::before, #cakeChoices::before { content:""; position:absolute; inset:0; background:rgba(0,0,0,0.5); z-index:-1; }

    .cake-tab { padding:18px 22px; border-radius:10px; color:white; font-size:18px; cursor:pointer; text-align:center; width:200px; font-weight:700; margin:10px; }
    #strawberryTab{background:#FF69B4;}
    #blueberryTab{background:#1E90FF;}
    #cherryTab{background:#c71585;}

    #recipePanel {
      position:fixed; top:18%; left:3%; z-index:9999; min-width:220px; padding:18px; border-radius:10px;
      font-size:16px; color:#fff; display:none; pointer-events:auto; box-shadow:0 6px 20px rgba(0,0,0,0.6);
      background: linear-gradient(135deg, rgba(0,0,0,0.6), rgba(0,0,0,0.4));
    }
    #recipePanel h2 { margin:0 0 8px; font-size:20px; text-align:center; }
    #recipePanel ul { list-style:none; padding:0; margin:0; max-height:60vh; overflow:auto; }
    #recipePanel li { margin:6px 0; font-weight:700; }
    #recipePanel li.collected { color: #9be6a1; text-decoration:line-through; }
  </style>
</head>
<body>
  <!-- Start UI -->
  <div id="startScreen">
    <h1 style="color:white;font-size:36px;margin-bottom:12px">Bake your cake</h1>
    <button onclick="startGame()" style="padding:12px 20px;font-size:18px;border-radius:8px;cursor:pointer">Start</button>
  </div>

  <div id="cakeChoices">
    <div style="display:flex;flex-direction:column;align-items:center;">
      <div class="cake-tab" id="strawberryTab" onclick="chooseCake('strawberry')">Strawberry Cake</div>
      <div class="cake-tab" id="blueberryTab" onclick="chooseCake('blueberry')">Blueberry Cake</div>
      <div class="cake-tab" id="cherryTab" onclick="chooseCake('cherry')">Cherry Cake</div>
      <button onclick="backToStart()" style="margin-top:12px;padding:8px 14px;border-radius:8px;cursor:pointer">Back</button>
    </div>
  </div>

  <div id="recipePanel"></div>

  <!-- Scene -->
  <a-scene id="scene" physics="gravity: -9.8;" style="display:none;">
    <!-- Player rig with physics body -->
    <a-entity id="rig" position="0 1.6 8" movement-controls kinematic-body>
      <a-camera id="firstPersonCam" look-controls camera="active:true">
        <a-cursor rayOrigin="mouse" fuse="false" material="color:black; shader:flat"></a-cursor>
      </a-camera>
    </a-entity>

    <!-- Lights -->
    <a-entity light="type:ambient; intensity:0.8"></a-entity>
    <a-entity light="type:directional; intensity:1.0" position="10 50 20"></a-entity>

    <!-- Kitchen objects with static-body so player can’t walk through -->
    <a-entity id="floor" gltf-model="floor.glb" static-body></a-entity>
    <a-entity id="fridge" gltf-model="fridge.glb" static-body></a-entity>
    <a-entity id="stove" gltf-model="stove.glb" static-body></a-entity>
    <a-entity id="countertopdecor" gltf-model="countertopdecor.glb" static-body></a-entity>
    <a-entity id="backwall" gltf-model="backwall.glb" static-body></a-entity>
    <a-entity id="frontwall" gltf-model="frontwall.glb" static-body></a-entity>
    <a-entity id="leftwall" gltf-model="leftwall.glb" static-body></a-entity>
    <a-entity id="rightwall" gltf-model="rightwall.glb" static-body></a-entity>
    <a-entity id="stool" gltf-model="stool.glb" static-body></a-entity>
    <a-entity id="plate" gltf-model="plate.glb" static-body></a-entity>
    <a-entity id="pan" gltf-model="pan.glb" static-body></a-entity>
    <a-entity id="eggcarton" gltf-model="eggcarton.glb" class="collectable" collectable data-name="eggcarton"></a-entity>

    <!-- Collectables (clickable) -->
    <a-entity id="flour" gltf-model="flour.glb" class="collectable" collectable data-name="flour"></a-entity>
    <a-entity id="sugar" gltf-model="sugar.glb" class="collectable" collectable data-name="sugar"></a-entity>
    <a-entity id="butter" gltf-model="butter.glb" class="collectable" collectable data-name="butter"></a-entity>
    <a-entity id="milk" gltf-model="milk.glb" class="collectable" collectable data-name="milk"></a-entity>
    <a-entity id="chocolate" gltf-model="chocolate.glb" class="collectable" collectable data-name="chocolate"></a-entity>
    <a-entity id="strawberry" gltf-model="strawberry.glb" class="collectable" collectable data-name="strawberry"></a-entity>
    <a-entity id="vanilla" gltf-model="vanilla.glb" class="collectable" collectable data-name="vanilla"></a-entity>
    <a-entity id="whisk" gltf-model="whisk.glb" class="collectable" collectable data-name="whisk"></a-entity>
  </a-scene>

  <script>
    let currentIngredients = [];
    let currentCake = "";

    function startGame(){
      document.getElementById('startScreen').style.display = 'none';
      document.getElementById('cakeChoices').style.display = 'flex';
    }
    function backToStart(){
      document.getElementById('cakeChoices').style.display = 'none';
      document.getElementById('startScreen').style.display = 'flex';
    }

    function chooseCake(cakeName){
      currentCake = cakeName;
      document.getElementById('cakeChoices').style.display = 'none';
      document.getElementById('scene').style.display = 'block';
      const recipePanel = document.getElementById('recipePanel');
      recipePanel.style.display = 'block';

      if (cakeName === 'blueberry') {
        currentIngredients = ["flour","sugar","butter","milk","vanilla","blueberry","strawberry","whisk","eggcarton"];
      } else if (cakeName === 'strawberry') {
        currentIngredients = ["flour","sugar","butter","milk","vanilla","chocolate","strawberry","whisk","eggcarton"];
      } else if (cakeName === 'cherry') {
        currentIngredients = ["flour","sugar","butter","milk","vanilla","cherries","whisk","eggcarton"];
      }

      recipePanel.innerHTML = `<h2>${cakeName.charAt(0).toUpperCase()+cakeName.slice(1)} Cake</h2>
        <ul>${currentIngredients.map(i => `<li id="recipe-${i}"><span class="check"></span> ${i}</li>`).join('')}</ul>`;
    }

    // Collectable component
    AFRAME.registerComponent('collectable',{
      init:function(){
        this.el.addEventListener('click', ()=>{
          const name = this.el.getAttribute('data-name');
          if(currentIngredients.includes(name)){
            this.el.setAttribute('visible', false);
            const li = document.getElementById(`recipe-${name}`);
            if(li){ li.querySelector('.check').textContent="✅"; li.classList.add('collected'); }
          }
        });
      }
    });
  </script>
</body>
</html>
