<!DOCTYPE html>
<html>
<head>
  <title>Bake your cake</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.3.0/dist/aframe-physics-system.min.js"></script>
</head>
<body>
  <!-- UI Screens -->
  <div id="startScreen" style="position:absolute;top:0;left:0;width:100%;height:100%;background:#fff;display:flex;align-items:center;justify-content:center;z-index:10;">
    <button onclick="startGame()">Start Game</button>
  </div>

  <div id="cakeChoices" style="display:none;position:absolute;top:10px;left:10px;z-index:10;flex-direction:column;gap:8px;background:white;padding:10px;border-radius:8px;">
    <p>Pick a cake:</p>
    <button onclick="chooseCake('chocolate')">Chocolate</button>
    <button onclick="chooseCake('vanilla')">Vanilla</button>
    <button onclick="chooseCake('strawberry')">Strawberry</button>
  </div>

  <!-- A-Frame Scene -->
  <a-scene physics="debug: false">
    <!-- Background Music -->
    <a-sound id="mainmusic" src="baking cooking jazz.mp3" autoplay="false" loop="true"></a-sound>

    <!-- Camera + Cursor -->
    <a-entity id="player" position="0 1.6 4">
      <a-camera id="camera">
        <a-cursor id="cursor" fuse="false" raycaster="objects: .collectable"></a-cursor>
      </a-camera>
    </a-entity>

    <!-- Kitchen Floor & Walls -->
    <a-box position="0 -0.5 0" width="10" height="1" depth="10" color="#c2b280"></a-box>
    <a-box position="0 2 -5" width="10" height="4" depth="0.1" color="#ffffff"></a-box>
    <a-box position="-5 2 0" width="0.1" height="4" depth="10" color="#eeeeee"></a-box>
    <a-box position="5 2 0" width="0.1" height="4" depth="10" color="#eeeeee"></a-box>
    <a-box position="0 2 5" width="10" height="4" depth="0.1" color="#eeeeee"></a-box>

    <!-- Kitchen Counter -->
    <a-box position="0 0 0" width="6" height="1" depth="2" color="#888888"></a-box>

    <!-- Collectable Objects -->
    <a-box class="collectable" data-name="Eggs" position="-1 1 0" color="yellow" depth="0.3" height="0.3" width="0.5"></a-box>
    <a-box class="collectable" data-name="Flour" position="0 1 0" color="white" depth="0.5" height="0.5" width="0.5"></a-box>
    <a-box class="collectable" data-name="Milk" position="1 1 0" color="blue" depth="0.5" height="0.5" width="0.5"></a-box>
    <a-box class="collectable" data-name="Sugar" position="2 1 0" color="pink" depth="0.5" height="0.5" width="0.5"></a-box>
    <a-box class="collectable" data-name="Butter" position="3 1 0" color="orange" depth="0.5" height="0.5" width="0.5"></a-box>
  </a-scene>

  <!-- Tooltip -->
  <div id="tooltip" style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.7);color:#fff;padding:5px 10px;border-radius:5px;font-family:sans-serif;display:none;z-index:20;">
    Press E to collect
  </div>

  <script>
    let collected = {};
    let hoveredCollectable = null;

    // Start game
    function startGame(){
      document.getElementById('startScreen').style.display='none';
      document.getElementById('cakeChoices').style.display='flex';

      // Start music after click
      const music = document.querySelector('#mainmusic');
      if (music && !music.components.sound.isPlaying) {
        music.components.sound.playSound();
      }
    }

    // Cake choice
    function chooseCake(type){
      alert("You chose: " + type + " cake! Now collect the ingredients.");
      document.getElementById('cakeChoices').style.display='none';
    }

    // Tooltip handling
    const tooltip = document.getElementById('tooltip');
    const cursor = document.querySelector('#cursor');

    cursor.addEventListener('raycaster-intersection', (evt) => {
      const el = evt.detail.els[0];
      if (el && el.classList.contains('collectable')) {
        hoveredCollectable = el;
        tooltip.style.display = 'block';
      }
    });

    cursor.addEventListener('raycaster-intersection-cleared', () => {
      hoveredCollectable = null;
      tooltip.style.display = 'none';
    });

    // Collect with E
    document.addEventListener("keydown", function(e){
      if (e.key.toLowerCase() === "e" && hoveredCollectable){
        let name = hoveredCollectable.getAttribute("data-name");
        if (!collected[name]){
          collected[name] = true;
          // Mark with ✅
          let tick = document.createElement("a-text");
          tick.setAttribute("value","✔");
          tick.setAttribute("color","green");
          tick.setAttribute("position","0 0.5 0");
          tick.setAttribute("align","center");
          hoveredCollectable.appendChild(tick);
        }
      }
    });
  </script>
</body>
</html>
